// Written by Denise Verbakel

/*
 * Note that we use a lookup table in order to make clear how the hamming weight is computed.
 * Another reason is that this is perfectly fine doable by hand in comparison to the box weight.
*/

/*
 * Differential hamming weight lookup table:
 *
 *	00000000 -> 00000000		0 + 0 = 0
 *	00000001 -> 01000000		1 + 1 = 2
 *	00000010 -> 10000000		1 + 1 = 2
 *	00000011 -> 11000000		2 + 2 = 4
 *	00000100 -> 01000101		1 + 3 = 4
 *	00000101 -> 00000101		2 + 2 = 4
 *	00000110 -> 11000101		2 + 4 = 6
 *	00000111 -> 10000101		3 + 3 = 6
 *	00001000 -> 10001010		1 + 3 = 4
 *	00001001 -> 11001010		2 + 4 = 6
 *	00001010 -> 00001010		2 + 2 = 4
 *	00001011 -> 01001010		3 + 3 = 6
 *	00001100 -> 11001111		2 + 6 = 8
 *	00001101 -> 10001111		3 + 5 = 8
 *	00001110 -> 01001111		3 + 5 = 8
 *	00001111 -> 00001111		4 + 4 = 8
 *
 *	00010000 -> 00000100		1 + 1 = 2
 *	00010001 -> 01000100		2 + 2 = 4
 *	00010010 -> 10000100		2 + 2 = 4
 *	00010011 -> 11000100		3 + 3 = 6
 *	00010100 -> 01000001		2 + 2 = 4
 *	00010101 -> 00000001		3 + 1 = 4
 *	00010110 -> 11000001		3 + 3 = 6
 *	00010111 -> 10000001		4 + 2 = 6
 *	00011000 -> 10001110		2 + 4 = 6
 *	00011001 -> 11001110		3 + 5 = 8
 *	00011010 -> 00001110		3 + 3 = 6
 *	00011011 -> 01001110		4 + 4 = 8
 *	00011100 -> 11001011		3 + 5 = 8
 *	00011101 -> 10001011		4 + 4 = 8
 *	00011110 -> 01001011		4 + 4 = 8
 *	00011111 -> 00001011		5 + 3 = 8
 *
 *	00100000 -> 00001000		1 + 1 = 2
 *	00100001 -> 01001000		2 + 2 = 4
 *	00100010 -> 10001000		2 + 2 = 4
 *	00100011 -> 11001000		3 + 3 = 6
 *	00100100 -> 01001101		2 + 4 = 6
 *	00100101 -> 00001101		3 + 3 = 6
 *	00100110 -> 11001101		3 + 5 = 8
 *	00100111 -> 10001101		4 + 4 = 8
 *	00101000 -> 10000010		2 + 2 = 4
 *	00101001 -> 11000010		3 + 3 = 6
 *	00101010 -> 00000010		3 + 1 = 4
 *	00101011 -> 01000010		4 + 2 = 6
 *	00101100 -> 11000111		3 + 5 = 8
 *	00101101 -> 10000111		4 + 4 = 8
 *	00101110 -> 01000111		4 + 4 = 8
 *	00101111 -> 00000111		5 + 3 = 8
 *
 *	00110000 -> 00001100		2 + 2 = 4
 *	00110001 -> 01001100		3 + 3 = 6
 *	00110010 -> 10001100		3 + 3 = 6
 *	00110011 -> 11001100		4 + 4 = 8
 *	00110100 -> 01001001		3 + 3 = 6
 *	00110101 -> 00001001		4 + 2 = 6
 *	00110110 -> 11001001		4 + 4 = 8
 *	00110111 -> 10001001		5 + 3 = 8
 *	00111000 -> 10000110		3 + 3 = 6
 *	00111001 -> 11000110		4 + 4 = 8
 *	00111010 -> 00000110		4 + 2 = 6
 *	00111011 -> 01000110		5 + 3 = 8
 *	00111100 -> 11000011		4 + 4 = 8
 *	00111101 -> 10000011		5 + 3 = 8
 *	00111110 -> 01000011		5 + 3 = 8
 *	00111111 -> 00000011		6 + 2 = 8
 *
 *	01000000 -> 01010001		1 + 3 = 4
 *	01000001 -> 00010001		2 + 2 = 4
 *	01000010 -> 11010001		2 + 4 = 6
 *	01000011 -> 10010001		3 + 3 = 6
 *	01000100 -> 00010100		2 + 2 = 4
 *	01000101 -> 01010100		3 + 3 = 6
 *	01000110 -> 10010100		3 + 3 = 6
 *	01000111 -> 11010100		4 + 4 = 8
 *	01001000 -> 11011011		2 + 6 = 8
 *	01001001 -> 10011011		3 + 5 = 8
 *	01001010 -> 01011011		3 + 5 = 8
 *	01001011 -> 00011011		4 + 4 = 8
 *	01001100 -> 10011110		3 + 5 = 8
 *	01001101 -> 11011110		4 + 6 = 10
 *	01001110 -> 00011110		4 + 4 = 8
 *	01001111 -> 01011110		5 + 5 = 10
 *
 *	01010000 -> 01010101		2 + 4 = 6
 *	01010001 -> 00010101		3 + 3 = 6
 *	01010010 -> 11010101		3 + 5 = 8
 *	01010011 -> 10010101		4 + 4 = 8
 *	01010100 -> 00010000		3 + 1 = 4
 *	01010101 -> 01010000		4 + 2 = 6
 *	01010110 -> 10010000		4 + 2 = 6
 *	01010111 -> 11010000		5 + 3 = 8
 *	01011000 -> 11011111		3 + 7 = 10
 *	01011001 -> 10011111		4 + 6 = 10
 *	01011010 -> 01011111		4 + 6 = 10
 *	01011011 -> 00011111		5 + 5 = 10
 *	01011100 -> 10011010		4 + 4 = 8
 *	01011101 -> 11011010		5 + 5 = 10
 *	01011110 -> 00011010		5 + 3 = 8
 *	01011111 -> 01011010		6 + 4 = 10
 *
 *	01100000 -> 01011001		2 + 4 = 6
 *	01100001 -> 00011001		3 + 3 = 6
 *	01100010 -> 11011001		3 + 5 = 8
 *	01100011 -> 10011001		4 + 4 = 8
 *	01100100 -> 00011100		3 + 3 = 6
 *	01100101 -> 01011100		4 + 4 = 8 
 *	01100110 -> 10011100		4 + 4 = 8
 *	01100111 -> 11011100		5 + 5 = 10
 *	01101000 -> 11010011		3 + 5 = 8
 *	01101001 -> 10010011		4 + 4 = 8
 *	01101010 -> 01010011		4 + 4 = 8
 *	01101011 -> 00010011		5 + 3 = 8
 *	01101100 -> 10010110		4 + 4 = 8
 *	01101101 -> 11010110		5 + 5 = 10
 *	01101110 -> 00010110		5 + 3 = 8
 *	01101111 -> 01010110		6 + 4 = 10
 *
 *	01110000 -> 01011101		3 + 5 = 8
 *	01110001 -> 00011101		4 + 4 = 8
 *	01110010 -> 11011101		4 + 6 = 10
 *	01110011 -> 10011101		5 + 5 = 10
 *	01110100 -> 00011000		4 + 2 = 6
 *	01110101 -> 01011000		5 + 3 = 8
 *	01110110 -> 10011000		5 + 3 = 8
 *	01110111 -> 11011000		6 + 4 = 10
 *	01111000 -> 11010111		4 + 6 = 10
 *	01111001 -> 10010111		5 + 5 = 10
 *	01111010 -> 01010111		5 + 5 = 10
 *	01111011 -> 00010111		6 + 4 = 10
 *	01111100 -> 10010010		5 + 3 = 8
 *	01111101 -> 11010010		6 + 4 = 10
 *	01111110 -> 00010010		6 + 2 = 8
 *	01111111 -> 01010010		7 + 3 = 10
 *
 *	10000000 -> 10100010		1 + 3 = 4
 *	10000001 -> 11100010		2 + 4 = 6
 *	10000010 -> 00100010		2 + 2 = 4
 *	10000011 -> 01100010		3 + 3 = 6
 *	10000100 -> 11100111		2 + 6 = 8
 *	10000101 -> 10100111		3 + 5 = 8
 *	10000110 -> 01100111		3 + 5 = 8
 *	10000111 -> 00100111		4 + 4 = 8
 *	10001000 -> 00101000		2 + 2 = 4
 *	10001001 -> 01101000		3 + 3 = 6
 *	10001010 -> 10101000		3 + 3 = 6
 *	10001011 -> 11101000		4 + 4 = 8
 *	10001100 -> 01101101		3 + 5 = 8
 *	10001101 -> 00101101		4 + 4 = 8
 *	10001110 -> 11101101		4 + 6 = 10
 *	10001111 -> 10101101		5 + 5 = 10
 *
 *	10010000 -> 10100110		2 + 4 = 6
 *	10010001 -> 11100110		3 + 5 = 8
 *	10010010 -> 00100110		3 + 3 = 6
 *	10010011 -> 01100110		4 + 4 = 8
 *	10010100 -> 11100011		3 + 5 = 8
 *	10010101 -> 10100011		4 + 4 = 8
 *	10010110 -> 01100011		4 + 4 = 8
 *	10010111 -> 00100011		5 + 3 = 8
 *	10011000 -> 00101100		3 + 3 = 6
 *	10011001 -> 01101100		4 + 4 = 8
 *	10011010 -> 10101100		4 + 4 = 8
 *	10011011 -> 11101100		5 + 5 = 10
 *	10011100 -> 01101001		4 + 4 = 8
 *	10011101 -> 00101001		5 + 3 = 8
 *	10011110 -> 11101001		5 + 5 = 10
 *	10011111 -> 10101001		6 + 4 = 10
 *
 *	10100000 -> 10101010		2 + 4 = 6
 *	10100001 -> 11101010		3 + 5 = 8
 *	10100010 -> 00101010		3 + 3 = 6
 *	10100011 -> 01101010		4 + 4 = 8
 *	10100100 -> 11101111		3 + 7 = 10
 *	10100101 -> 10101111		4 + 6 = 10
 *	10100110 -> 01101111		4 + 6 = 10
 *	10100111 -> 00101111		5 + 5 = 10
 *	10101000 -> 00100000		3 + 1 = 4
 *	10101001 -> 01100000		4 + 2 = 6
 *	10101010 -> 10100000		4 + 2 = 6
 *	10101011 -> 11100000		5 + 3 = 8
 *	10101100 -> 01100101		4 + 4 = 8
 *	10101101 -> 00100101		5 + 3 = 8
 *	10101110 -> 11100101		5 + 5 = 10
 *	10101111 -> 10100101		6 + 4 = 10
 *
 *	10110000 -> 10101110		3 + 5 = 8		
 *	10110001 -> 11101110		4 + 6 = 10
 *	10110010 -> 00101110		4 + 4 = 8
 *	10110011 -> 01101110		5 + 5 = 10
 *	10110100 -> 11101011		4 + 6 = 10
 *	10110101 -> 10101011		5 + 5 = 10
 *	10110110 -> 01101011		5 + 5 = 10
 *	10110111 -> 00101011		6 + 4 = 10
 *	10111000 -> 00100100		4 + 2 = 6
 *	10111001 -> 01100100		5 + 3 = 8
 *	10111010 -> 10100100		5 + 3 = 8
 *	10111011 -> 11100100		6 + 4 = 10
 *	10111100 -> 01100001		5 + 3 = 8
 *	10111101 -> 00100001		6 + 2 = 8
 *	10111110 -> 11100001		6 + 4 = 10
 *	10111111 -> 10100001		7 + 3 = 10
 *
 *	11000000 -> 11110011		2 + 6 = 8
 *	11000001 -> 10110011		3 + 5 = 8
 *	11000010 -> 01110011		3 + 5 = 8
 *	11000011 -> 00110011		4 + 4 = 8
 *	11000100 -> 10110110		3 + 5 = 8
 *	11000101 -> 11110110		4 + 6 = 10
 *	11000110 -> 00110110		4 + 4 = 8
 *	11000111 -> 01110110		5 + 5 = 10
 *	11001000 -> 01111001		3 + 5 = 8
 *	11001001 -> 00111001		4 + 4 = 8
 *	11001010 -> 11111001		4 + 6 = 10
 *	11001011 -> 10111001		5 + 5 = 10
 *	11001100 -> 00111100		4 + 4 = 8
 *	11001101 -> 01111100		5 + 5 = 10
 *	11001110 -> 10111100		5 + 5 = 10
 *	11001111 -> 11111100		6 + 6 = 12
 *
 *	11010000 -> 11110111		3 + 7 = 10
 *	11010001 -> 10110111		4 + 6 = 10
 *	11010010 -> 01110111		4 + 6 = 10
 *	11010011 -> 00110111		5 + 5 = 10
 *	11010100 -> 10110010		4 + 4 = 8
 *	11010101 -> 11110010		5 + 5 = 10
 *	11010110 -> 00110010		5 + 3 = 8
 *	11010111 -> 01110010		6 + 4 = 10
 *	11011000 -> 01111101		4 + 6 = 10
 *	11011001 -> 00111101		5 + 5 = 10
 *	11011010 -> 11111101		5 + 7 = 12
 *	11011011 -> 10111101		6 + 6 = 12
 *	11011100 -> 00111000		5 + 3 = 8
 *	11011101 -> 01111000		6 + 4 = 10
 *	11011110 -> 10111000		6 + 4 = 10
 *	11011111 -> 11111000		7 + 5 = 12
 *
 *	11100000 -> 11111011		3 + 7 = 10
 *	11100001 -> 10111011		4 + 6 = 10
 *	11100010 -> 01111011		4 + 6 = 10
 *	11100011 -> 00111011		5 + 5 = 10
 *	11100100 -> 10111110		4 + 6 = 10
 *	11100101 -> 11111110		5 + 7 = 12
 *	11100110 -> 00111110		5 + 5 = 10
 *	11100111 -> 01111110		6 + 6 = 12
 *	11101000 -> 01110001		4 + 4 = 8
 *	11101001 -> 00110001		5 + 3 = 8
 *	11101010 -> 11110001		5 + 5 = 10
 *	11101011 -> 10110001		6 + 4 = 10
 *	11101100 -> 00110100		5 + 3 = 8
 *	11101101 -> 01110100		6 + 4 = 10
 *	11101110 -> 10110100		6 + 4 = 10
 *	11101111 -> 11110100		7 + 5 = 12
 *
 *	11110000 -> 11111111		4 + 8 = 12
 *	11110001 -> 10111111		5 + 7 = 12
 *	11110010 -> 01111111		5 + 7 = 12
 *	11110011 -> 00111111		6 + 6 = 12
 *	11110100 -> 10111010		5 + 5 = 10
 *	11110101 -> 11111010		6 + 6 = 12
 *	11110110 -> 00111010		6 + 4 = 10
 *	11110111 -> 01111010		7 + 5 = 12
 *	11111000 -> 01110101		5 + 5 = 10
 *	11111001 -> 00110101		6 + 4 = 10
 *	11111010 -> 11110101		6 + 6 = 12
 *	11111011 -> 10110101		7 + 5 = 12
 *	11111100 -> 00110000		6 + 2 = 8
 *	11111101 -> 01110000		7 + 3 = 10
 *	11111110 -> 10110000		7 + 3 = 10
 *	11111111 -> 11110000		8 + 4 = 12
 *
 * The lookup table for the differential hamming weight is obtained by multiplying all possible 8 bit vectors 
 * as a (4x2)-matrix by the following (4x4)-matrix:
 *	1  0  1  1
 *	1  0  0  0
 *	0  1  1  0
 *	1  0  1  0
 * We then count the bits set to 1 in the 8 bit input vector and the bits set to 1 in the 8 bit output vector.
*/

const int lookup_table_differential_hamming_weight[256][2] = {
	{0, 0},
	{1, 1},
	{1, 1},
	{2, 2},
	{1, 3},
	{2, 2},
	{2, 4},
	{3, 3},
	{1, 3},
	{2, 4},
	{2, 2},
	{3, 3},
	{2, 6},
	{3, 5},
	{3, 5},
	{4, 4},
	{1, 1},
	{2, 2},
	{2, 2},
	{3, 3},
	{2, 2},
	{3, 1},
	{3, 3},
	{4, 2},
	{2, 4},
	{3, 5},
	{3, 3},
	{4, 4},
	{3, 5},
	{4, 4},
	{4, 4},
	{5, 3},
	{1, 1},
	{2, 2},
	{2, 2},
	{3, 3},
	{2, 4},
	{3, 3},
	{3, 5},
	{4, 4},
	{2, 2},
	{3, 3},
	{3, 1},
	{4, 2},
	{3, 5},
	{4, 4},
	{4, 4},
	{5, 3},
	{2, 2},
	{3, 3},
	{3, 3},
	{4, 4},
	{3, 3},
	{4, 2},
	{4, 4},
	{5, 3},
	{3, 3},
	{4, 4},
	{4, 2},
	{5, 3},
	{4, 4},
	{5, 3},
	{5, 3},
	{6, 2},
	{1, 3},
	{2, 2},
	{2, 4},
	{3, 3},
	{2, 2},
	{3, 3},
	{3, 3},
	{4, 4},
	{2, 6},
	{3, 5},
	{3, 5},
	{4, 4},
	{3, 5},
	{4, 6},
	{4, 4},
	{5, 5},
	{2, 4},
	{3, 3},
	{3, 5},
	{4, 4},
	{3, 1},
	{4, 2},
	{4, 2},
	{5, 3},
	{3, 7},
	{4, 6},
	{4, 6},
	{5, 5},
	{4, 4},
	{5, 5},
	{5, 3},
	{6, 4},
	{2, 4},
	{3, 3},
	{3, 5},
	{4, 4},
	{3, 3},
	{4, 4},
	{4, 4},
	{5, 5},
	{3, 5},
	{4, 4},
	{4, 4},
	{5, 3},
	{4, 4},
	{5, 5},
	{5, 3},
	{6, 4},
	{3, 5},
	{4, 4},
	{4, 6},
	{5, 5},
	{4, 2},
	{5, 3},
	{5, 3},
	{6, 4},
	{4, 6},
	{5, 5},
	{5, 5},
	{6, 4},
	{5, 3},
	{6, 4},
	{6, 2},
	{7, 3},
	{1, 3},
	{2, 4},
	{2, 2},
	{3, 3},
	{2, 6},
	{3, 5},
	{3, 5},
	{4, 4},
	{2, 2},
	{3, 3},
	{3, 3},
	{4, 4},
	{3, 5},
	{4, 4},
	{4, 6},
	{5, 5},
	{2, 4},
	{3, 5},
	{3, 3},
	{4, 4},
	{3, 5},
	{4, 4},
	{4, 4},
	{5, 3},
	{3, 3},
	{4, 4},
	{4, 4},
	{5, 5},
	{4, 4},
	{5, 3},
	{5, 5},
	{6, 4},
	{2, 4},
	{3, 5},
	{3, 3},
	{4, 4},
	{3, 7},
	{4, 6},
	{4, 6},
	{5, 5},
	{3, 1},
	{4, 2},
	{4, 2},
	{5, 3},
	{4, 4},
	{5, 3},
	{5, 5},
	{6, 4},
	{3, 5},
	{4, 6},
	{4, 4},
	{5, 5},
	{4, 6},
	{5, 5},
	{5, 5},
	{6, 4},
	{4, 2},
	{5, 3},
	{5, 3},
	{6, 4},
	{5, 3},
	{6, 2},
	{6, 4},
	{7, 3},
	{2, 6},
	{3, 5},
	{3, 5},
	{4, 4},
	{3, 5},
	{4, 6},
	{4, 4},
	{5, 5},
	{3, 5},
	{4, 4},
	{4, 6},
	{5, 5},
	{4, 4},
	{5, 5},
	{5, 5},
	{6, 6},
	{3, 7},
	{4, 6},
	{4, 6},
	{5, 5},
	{4, 4},
	{5, 5},
	{5, 3},
	{6, 4},
	{4, 6},
	{5, 5},
	{5, 7},
	{6, 6},
	{5, 3},
	{6, 4},
	{6, 4},
	{7, 5},
	{3, 7},
	{4, 6},
	{4, 6},
	{5, 5},
	{4, 6},
	{5, 7},
	{5, 5},
	{6, 6},
	{4, 4},
	{5, 3},
	{5, 5},
	{6, 4},
	{5, 3},
	{6, 4},
	{6, 4},
	{7, 5},
	{4, 8},
	{5, 7},
	{5, 7},
	{6, 6},
	{5, 5},
	{6, 6},
	{6, 4},
	{7, 5},
	{5, 5},
	{6, 4},
	{6, 6},
	{7, 5},
	{6, 2},
	{7, 3},
	{7, 3},
	{8, 4},
};

/*
 * Linear hamming weight lookup table:
 *
 *	00000000 -> 00000000		0 + 0 = 0
 *	00000001 -> 01000100		1 + 2 = 3
 *	00000010 -> 10001000		1 + 2 = 3
 *	00000011 -> 11001100		2 + 4 = 6
 *	00000100 -> 00010100		1 + 2 = 3
 *	00000101 -> 01010000		2 + 2 = 4
 *	00000110 -> 10011100		2 + 4 = 6
 *	00000111 -> 11011000		3 + 4 = 7
 *	00001000 -> 00101000		1 + 2 = 3
 *	00001001 -> 01101100		2 + 4 = 6
 *	00001010 -> 10100000		2 + 2 = 4
 *	00001011 -> 11100100		3 + 4 = 7
 *	00001100 -> 00111100		2 + 4 = 6
 *	00001101 -> 01111000		3 + 4 = 7
 *	00001110 -> 10110100		3 + 4 = 7
 *	00001111 -> 11110000		4 + 4 = 8
 *
 *	00010000 -> 01000000		1 + 1 = 2
 *	00010001 -> 00000100		2 + 1 = 3
 *	00010010 -> 11001000		2 + 3 = 5
 *	00010011 -> 10001100		3 + 3 = 6
 *	00010100 -> 01010100		2 + 3 = 5
 *	00010101 -> 00010000		3 + 1 = 4
 *	00010110 -> 11011100		3 + 5 = 8
 *	00010111 -> 10011000		4 + 3 = 7
 *	00011000 -> 01101000		2 + 3 = 5
 *	00011001 -> 00101100		3 + 3 = 6
 *	00011010 -> 11100000		3 + 3 = 6
 *	00011011 -> 10100100		4 + 3 = 7
 *	00011100 -> 01111100		3 + 5 = 8
 *	00011101 -> 00111000		4 + 3 = 7
 *	00011110 -> 11110100		4 + 5 = 9
 *	00011111 -> 10110000		5 + 3 = 8
 *
 *	00100000 -> 10000000		1 + 1 = 2
 *	00100001 -> 11000100		2 + 3 = 5
 *	00100010 -> 00001000		2 + 1 = 3
 *	00100011 -> 01001100		3 + 3 = 6
 *	00100100 -> 10010100		2 + 3 = 5
 *	00100101 -> 11010000		3 + 3 = 6
 *	00100110 -> 00011100		3 + 3 = 6
 *	00100111 -> 01011000		4 + 3 = 7
 *	00101000 -> 10101000		2 + 3 = 5
 *	00101001 -> 11101100		3 + 5 = 8
 *	00101010 -> 00100000		3 + 1 = 4
 *	00101011 -> 01100100		4 + 3 = 7
 *	00101100 -> 10111100		3 + 5 = 8
 *	00101101 -> 11111000		4 + 5 = 9
 *	00101110 -> 00110100		4 + 3 = 7
 *	00101111 -> 01110000		5 + 3 = 8
 *
 *	00110000 -> 11000000		2 + 2 = 4
 *	00110001 -> 10000100		3 + 2 = 5
 *	00110010 -> 01001000		3 + 2 = 5
 *	00110011 -> 00001100		4 + 2 = 6
 *	00110100 -> 11010100		3 + 4 = 7
 *	00110101 -> 10010000		4 + 2 = 6
 *	00110110 -> 01011100		4 + 4 = 8
 *	00110111 -> 00011000		5 + 2 = 7
 *	00111000 -> 11101000		3 + 4 = 7
 *	00111001 -> 10101100		4 + 4 = 8
 *	00111010 -> 01100000		4 + 2 = 6
 *	00111011 -> 00100100		5 + 2 = 7
 *	00111100 -> 11111100		4 + 6 = 10
 *	00111101 -> 10111000		5 + 4 = 9
 *	00111110 -> 01110100		5 + 4 = 9
 *	00111111 -> 00110000		6 + 2 = 8
 *
 *	01000000 -> 01000101		1 + 3 = 4
 *	01000001 -> 00000001		2 + 1 = 3
 *	01000010 -> 11001101		2 + 5 = 7
 *	01000011 -> 10001001		3 + 3 = 6
 *	01000100 -> 01010001		2 + 3 = 5
 *	01000101 -> 00010101		3 + 3 = 6
 *	01000110 -> 11011001		3 + 5 = 8
 *	01000111 -> 10011101		4 + 5 = 9
 *	01001000 -> 01101101		2 + 5 = 7
 *	01001001 -> 00101001		3 + 3 = 6
 *	01001010 -> 11100101		3 + 5 = 8
 *	01001011 -> 10100001		4 + 3 = 7
 *	01001100 -> 01111001		3 + 5 = 8
 *	01001101 -> 00111101		4 + 5 = 9
 *	01001110 -> 11110001		4 + 5 = 9
 *	01001111 -> 10110101		5 + 5 = 10
 *
 *	01010000 -> 00000101		2 + 2 = 4
 *	01010001 -> 01000001		3 + 2 = 5
 *	01010010 -> 10001101		3 + 4 = 7
 *	01010011 -> 11001001		4 + 4 = 8
 *	01010100 -> 00010001		3 + 2 = 5
 *	01010101 -> 01010101		4 + 4 = 8
 *	01010110 -> 10011001		4 + 4 = 8
 *	01010111 -> 11011101		5 + 6 = 11
 *	01011000 -> 00101101		3 + 4 = 7
 *	01011001 -> 01101001		4 + 4 = 8
 *	01011010 -> 10100101		4 + 4 = 8
 *	01011011 -> 11100001		5 + 4 = 9
 *	01011100 -> 00111001		4 + 4 = 8
 *	01011101 -> 01111101		5 + 6 = 11
 *	01011110 -> 10110001		5 + 4 = 9
 *	01011111 -> 11110101		6 + 6 = 12
 *
 *	01100000 -> 11000101		2 + 4 = 6
 *	01100001 -> 10000001		3 + 2 = 5
 *	01100010 -> 01001101		3 + 4 = 7
 *	01100011 -> 00001001		4 + 2 = 6
 *	01100100 -> 11010001		3 + 4 = 7
 *	01100101 -> 10010101		4 + 4 = 8
 *	01100110 -> 01011001		4 + 4 = 8
 *	01100111 -> 00011101		5 + 4 = 9
 *	01101000 -> 11101101		3 + 6 = 9
 *	01101001 -> 10101001		4 + 4 = 8
 *	01101010 -> 01100101		4 + 4 = 8
 *	01101011 -> 00100001		5 + 2 = 7
 *	01101100 -> 11111001		4 + 6 = 10
 *	01101101 -> 10111101		5 + 6 = 11
 *	01101110 -> 01110001		5 + 4 = 9
 *	01101111 -> 00110101		6 + 4 = 10
 *
 *	01110000 -> 10000101		3 + 3 = 6
 *	01110001 -> 11000001		4 + 3 = 7
 *	01110010 -> 00001101		4 + 3 = 7
 *	01110011 -> 01001001		5 + 3 = 8
 *	01110100 -> 10010001		4 + 3 = 7
 *	01110101 -> 11010101		5 + 5 = 10
 *	01110110 -> 00011001		5 + 3 = 8
 *	01110111 -> 01011101		6 + 5 = 11
 *	01111000 -> 10101101		4 + 5 = 9
 *	01111001 -> 11101001		5 + 5 = 10
 *	01111010 -> 00100101		5 + 3 = 8
 *	01111011 -> 01100001		6 + 3 = 9
 *	01111100 -> 10111001		5 + 5 = 10
 *	01111101 -> 11111101		6 + 7 = 13
 *	01111110 -> 00110001		6 + 3 = 9
 *	01111111 -> 01110101		7 + 5 = 12
 *
 *	10000000 -> 10001010		1 + 3 = 4
 *	10000001 -> 11001110		2 + 5 = 7
 *	10000010 -> 00000010		2 + 1 = 3
 *	10000011 -> 01000110		3 + 3 = 6
 *	10000100 -> 10011110		2 + 5 = 7
 *	10000101 -> 11011010		3 + 5 = 8
 *	10000110 -> 00010110		3 + 3 = 6
 *	10000111 -> 01010010		4 + 3 = 7
 *	10001000 -> 10100010		2 + 3 = 5
 *	10001001 -> 11100110		3 + 5 = 8
 *	10001010 -> 00101010		3 + 3 = 6
 *	10001011 -> 01101110		4 + 5 = 9
 *	10001100 -> 10110110		3 + 5 = 8
 *	10001101 -> 11110010		4 + 5 = 9
 *	10001110 -> 00111110		4 + 5 = 11
 *	10001111 -> 01111010		5 + 5 = 10
 *
 *	10010000 -> 11001010		2 + 4 = 6
 *	10010001 -> 10001110		3 + 4 = 7
 *	10010010 -> 01000010		3 + 2 = 5
 *	10010011 -> 00000110		4 + 2 = 6
 *	10010100 -> 11011110		3 + 6 = 9
 *	10010101 -> 10011010		4 + 4 = 8
 *	10010110 -> 01010110		4 + 4 = 8
 *	10010111 -> 00010010		5 + 2 = 7
 *	10011000 -> 11100010		3 + 4 = 7
 *	10011001 -> 10100110		4 + 4 = 8
 *	10011010 -> 01101010		4 + 4 = 8
 *	10011011 -> 00101110		5 + 4 = 9
 *	10011100 -> 11110110		4 + 6 = 10
 *	10011101 -> 10110010		5 + 4 = 9
 *	10011110 -> 01111110		5 + 6 = 11
 *	10011111 -> 00111010		6 + 4 = 10
 *
 *	10100000 -> 00001010		2 + 2 = 4
 *	10100001 -> 01001110		3 + 4 = 7
 *	10100010 -> 10000010		3 + 2 = 5
 *	10100011 -> 11000110		4 + 4 = 8
 *	10100100 -> 00011110		3 + 4 = 7
 *	10100101 -> 01011010		4 + 4 = 8
 *	10100110 -> 10010110		4 + 4 = 8
 *	10100111 -> 11010010		5 + 4 = 9
 *	10101000 -> 00100010		3 + 2 = 5
 *	10101001 -> 01100110		4 + 4 = 8
 *	10101010 -> 10101010		4 + 4 = 8
 *	10101011 -> 11101110		5 + 6 = 11
 *	10101100 -> 00110110		4 + 4 = 8
 *	10101101 -> 01110010		5 + 4 = 9
 *	10101110 -> 10111110		5 + 6 = 11
 *	10101111 -> 11111010		6 + 6 = 12
 *
 *	10110000 -> 01001010		3 + 3 = 6
 *	10110001 -> 00001110		4 + 3 = 7
 *	10110010 -> 11000010		4 + 3 = 7
 *	10110011 -> 10000110		5 + 3 = 8
 *	10110100 -> 01011110		4 + 5 = 9
 *	10110101 -> 00011010		5 + 3 = 8
 *	10110110 -> 11010110		5 + 5 = 10
 *	10110111 -> 10010010		6 + 3 = 9
 *	10111000 -> 01100010		4 + 3 = 7
 *	10111001 -> 00100110		5 + 3 = 8
 *	10111010 -> 11101010		5 + 5 = 10
 *	10111011 -> 10101110		6 + 5 = 11
 *	10111100 -> 01110110		5 + 5 = 10
 *	10111101 -> 00110010		6 + 3 = 9
 *	10111110 -> 11111110		6 + 7 = 13
 *	10111111 -> 10111010		7 + 5 = 12
 *
 *	11000000 -> 11001111		2 + 6 = 8
 *	11000001 -> 10001011		3 + 4 = 7
 *	11000010 -> 01000111		3 + 4 = 7
 *	11000011 -> 00000011		4 + 2 = 6
 *	11000100 -> 11011011		3 + 6 = 9
 *	11000101 -> 10011111		4 + 6 = 10
 *	11000110 -> 01010011		4 + 4 = 8
 *	11000111 -> 00010111		5 + 4 = 9
 *	11001000 -> 11100111		3 + 6 = 9
 *	11001001 -> 10100011		4 + 4 = 8
 *	11001010 -> 01101111		4 + 6 = 9
 *	11001011 -> 00101011		5 + 4 = 9
 *	11001100 -> 11110011		4 + 6 = 10
 *	11001101 -> 10110111		5 + 6 = 11
 *	11001110 -> 01111011		5 + 6 = 11
 *	11001111 -> 00111111		6 + 6 = 12
 *
 *	11010000 -> 10001111		3 + 5 = 8
 *	11010001 -> 11001011		4 + 5 = 9
 *	11010010 -> 00000111		4 + 3 = 7
 *	11010011 -> 01000011		5 + 3 = 8
 *	11010100 -> 10011011		4 + 5 = 9
 *	11010101 -> 11011111		5 + 7 = 12
 *	11010110 -> 00010011		5 + 3 = 8
 *	11010111 -> 01010111		6 + 5 = 11
 *	11011000 -> 10100111		4 + 5 = 9
 *	11011001 -> 11100011		5 + 5 = 10
 *	11011010 -> 00101111		5 + 5 = 10
 *	11011011 -> 01101011		6 + 5 = 11
 *	11011100 -> 10110011		5 + 5 = 10
 *	11011101 -> 11110111		6 + 7 = 13
 *	11011110 -> 00111011		6 + 5 = 11
 *	11011111 -> 01111111		7 + 7 = 14
 *
 *	11100000 -> 01001111		3 + 5 = 8
 *	11100001 -> 00001011		4 + 3 = 7
 *	11100010 -> 11000111		4 + 5 = 9
 *	11100011 -> 10000011		5 + 3 = 8
 *	11100100 -> 01011011		4 + 5 = 9
 *	11100101 -> 00011111		5 + 5 = 10
 *	11100110 -> 11010011		5 + 5 = 10
 *	11100111 -> 10010111		6 + 5 = 11
 *	11101000 -> 01100111		4 + 5 = 9
 *	11101001 -> 00100011		5 + 3 = 8
 *	11101010 -> 11101111		5 + 7 = 12
 *	11101011 -> 10101011		6 + 5 = 11
 *	11101100 -> 01110011		5 + 5 = 10
 *	11101101 -> 00110111		6 + 5 = 11
 *	11101110 -> 11111011		6 + 7 = 13
 *	11101111 -> 10111111		7 + 7 = 14
 *
 *	11110000 -> 00001111		4 + 4 = 8
 *	11110001 -> 01001011		5 + 4 = 9
 *	11110010 -> 10000111		5 + 4 = 9
 *	11110011 -> 11000011		6 + 4 = 10
 *	11110100 -> 00011011		5 + 4 = 9
 *	11110101 -> 01011111		6 + 6 = 12
 *	11110110 -> 10010011		6 + 4 = 10
 *	11110111 -> 11010111		7 + 6 = 13
 *	11111000 -> 00100111		5 + 4 = 9
 *	11111001 -> 01100011		6 + 4 = 10
 *	11111010 -> 10101111		6 + 6 = 12
 *	11111011 -> 11101011		7 + 6 = 13
 *	11111100 -> 00110011		6 + 4 = 10
 *	11111101 -> 01110111		7 + 6 = 13
 *	11111110 -> 10111011		7 + 6 = 13
 *	11111111 -> 11111111		8 + 8 = 16
 *
 * The lookup table for the linear hamming weight is obtained by multiplying all possible 8 bit vectors 
 * as a (4x2)-matrix by the following (4x4)-matrix:
 *	1  1  0  1
 *	0  0  1  0
 *	1  0  1  1
 *	1  0  0  0
 * Note: this is the transpose of the matrix above.
 * We then count the bits set to 1 in the 8 bit input vector and the bits set to 1 in the 8 bit output vector.
*/

const int lookup_table_linear_hamming_weight[256][2] = {
	{0, 0},
	{1, 2},
	{1, 2},
	{2, 4},
	{1, 2},
	{2, 2},
	{2, 4},
	{3, 4},
	{1, 2},
	{2, 4},
	{2, 2},
	{3, 4},
	{2, 4},
	{3, 4},
	{3, 4},
	{4, 4},
	{1, 1},
	{2, 1},
	{2, 3},
	{3, 3},
	{2, 3},
	{3, 1},
	{3, 5},
	{4, 3},
	{2, 3},
	{3, 3},
	{3, 3},
	{4, 3},
	{3, 5},
	{4, 3},
	{4, 5},
	{5, 3},
	{1, 1},
	{2, 3},
	{2, 1},
	{3, 3},
	{2, 3},
	{3, 3},
	{3, 3},
	{4, 3},
	{2, 3},
	{3, 5},
	{3, 1},
	{4, 3},
	{3, 5},
	{4, 5},
	{4, 3},
	{5, 3},
	{2, 2},
	{3, 2},
	{3, 2},
	{4, 2},
	{3, 4},
	{4, 2},
	{4, 4},
	{5, 2},
	{3, 4},
	{4, 4},
	{4, 2},
	{5, 2},
	{4, 6},
	{5, 4},
	{5, 4},
	{6, 2},
	{1, 3},
	{2, 1},
	{2, 5},
	{3, 3},
	{2, 3},
	{3, 3},
	{3, 5},
	{4, 5},
	{2, 5},
	{3, 3},
	{3, 5},
	{4, 3},
	{3, 5},
	{4, 5},
	{4, 5},
	{5, 5},
	{2, 2},
	{3, 2},
	{3, 4},
	{4, 4},
	{3, 2},
	{4, 4},
	{4, 4},
	{5, 6},
	{3, 4},
	{4, 4},
	{4, 4},
	{5, 4},
	{4, 4},
	{5, 6},
	{5, 4},
	{6, 6},
	{2, 4},
	{3, 2},
	{3, 4},
	{4, 2},
	{3, 4},
	{4, 4},
	{4, 4},
	{5, 4},
	{3, 6},
	{4, 4},
	{4, 4},
	{5, 2},
	{4, 6},
	{5, 6},
	{5, 4},
	{6, 4},
	{3, 3},
	{4, 3},
	{4, 3},
	{5, 3},
	{4, 3},
	{5, 5},
	{5, 3},
	{6, 5},
	{4, 5},
	{5, 5},
	{5, 3},
	{6, 3},
	{5, 5},
	{6, 7},
	{6, 3},
	{7, 5},
	{1, 3},
	{2, 5},
	{2, 1},
	{3, 3},
	{2, 5},
	{3, 5},
	{3, 3},
	{4, 3},
	{2, 3},
	{3, 5},
	{3, 3},
	{4, 5},
	{3, 5},
	{4, 5},
	{4, 5},
	{5, 5},
	{2, 4},
	{3, 4},
	{3, 2},
	{4, 2},
	{3, 6},
	{4, 4},
	{4, 4},
	{5, 2},
	{3, 4},
	{4, 4},
	{4, 4},
	{5, 4},
	{4, 6},
	{5, 4},
	{5, 6},
	{6, 4},
	{2, 2},
	{3, 4},
	{3, 2},
	{4, 4},
	{3, 4},
	{4, 4},
	{4, 4},
	{5, 4},
	{3, 2},
	{4, 4},
	{4, 4},
	{5, 6},
	{4, 4},
	{5, 4},
	{5, 6},
	{6, 6},
	{3, 3},
	{4, 3},
	{4, 3},
	{5, 3},
	{4, 5},
	{5, 3},
	{5, 5},
	{6, 3},
	{4, 3},
	{5, 3},
	{5, 5},
	{6, 5},
	{5, 5},
	{6, 3},
	{6, 7},
	{7, 5},
	{2, 6},
	{3, 4},
	{3, 4},
	{4, 2},
	{3, 6},
	{4, 6},
	{4, 4},
	{5, 4},
	{3, 6},
	{4, 4},
	{4, 6},
	{5, 4},
	{4, 6},
	{5, 6},
	{5, 6},
	{6, 6},
	{3, 5},
	{4, 5},
	{4, 3},
	{5, 3},
	{4, 5},
	{5, 7},
	{5, 3},
	{6, 5},
	{4, 5},
	{5, 5},
	{5, 5},
	{6, 5},
	{5, 5},
	{6, 7},
	{6, 5},
	{7, 7},
	{3, 5},
	{4, 3},
	{4, 5},
	{5, 3},
	{4, 5},
	{5, 5},
	{5, 5},
	{6, 5},
	{4, 5},
	{5, 3},
	{5, 7},
	{6, 5},
	{5, 5},
	{6, 5},
	{6, 7},
	{7, 7},
	{4, 4},
	{5, 4},
	{5, 4},
	{6, 4},
	{5, 4},
	{6, 6},
	{6, 4},
	{7, 6},
	{5, 4},
	{6, 4},
	{6, 6},
	{7, 6},
	{6, 4},
	{7, 6},
	{7, 6},
	{8, 8},
};

